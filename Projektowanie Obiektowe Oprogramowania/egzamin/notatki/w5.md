# Wykład 5 - Wzorce strukturalne

## 1. Facade

Uproszczony interfejs dla podsystemu z wieloma interfejsami.

- Celem wzorca jest ukrycie złożoności systemu.
- Facade udostępnia uproszczony interfejs dla zestawu klas.
- Stosowany często do „opakowania” bibliotek lub skomplikowanych API.

## 2. Read-only interface

Interfejs do odczytu dla wszystkich, a do zapisu tylko dla wybranych.

- Stosowany w celu ograniczenia możliwości modyfikacji danych.
- Przykład: `ReadOnlyCollection`, `AsReadOnly()`
- Projektowane są dwa interfejsy:
  - Interfejs do odczytu (`ReadOnlyInterface`)
  - Interfejs do modyfikacji (`MutableInterface`)
- Klient korzystający tylko z odczytu nie widzi metod modyfikujących.

## 3. Flyweight

Efektywne zarządzanie wieloma drobnymi obiektami.

- **Cel:** zmniejszenie zużycia pamięci przez współdzielenie danych.
- Kojarzony z: `Object Pool`, `immutable`, wiele danych.
- **FlyweightFactory**:
  - Utrzymuje niewielką liczbę współdzielonych instancji.
  - Zwraca te same obiekty na podstawie klucza (np. koloru bierki).
- **Stan obiektu:**
  - *Intrinsic*: wspólny dla wielu obiektów (np. kolor).
  - *Extrinsic*: przekazywany z zewnątrz (np. pozycja X/Y).

Przykład: plansza do warcabów 1mln x 1mln – tylko dwie bierki w pamięci: biała i czarna.

## 4. Decorator

Dynamiczne rozszerzanie odpowiedzialności obiektów (alternatywa dla podklas).

- Pozwala "owijać" obiekty innymi obiektami w celu dodania funkcjonalności.
- Popularny w bibliotekach do przetwarzania strumieni.
- Każdy dekorator implementuje ten sam interfejs co dekorowany obiekt.
- Może być stosowany wielokrotnie (rekursywność).
- Kluczowe cechy:
  - Zachowanie oryginalnego interfejsu.
  - Możliwość dowolnej kombinacji dekoratorów.

## 5. Proxy

Substytut obiektu w celu kontrolowania dostępu do niego.

### Rodzaje Proxy:
- **Zdalne (Remote)** – lokalny reprezentant zdalnego obiektu.
- **Wirtualne (Virtual)** – leniwe tworzenie kosztownego obiektu.
- **Ochronne (Protective)** – kontrola dostępu (np. autoryzacja).
- **Logujące (Logging)** – rejestruje dostęp do obiektu.

### Różnice Proxy vs Decorator:
- **Proxy** nie rozszerza interfejsu, jedynie kontroluje dostęp.
- **Decorator** może dodawać nowe funkcje i zachowania.

### Szczególny przypadek: **Circuit Breaker**
- Monitoruje liczbę błędów w wywołaniach zdalnych.
- Po przekroczeniu limitu przechodzi w tryb lokalny.
- Po czasie podejmuje próbę przywrócenia połączenia.

## 6. Adapter

Uzgadnianie niezgodnych interfejsów.

- Umożliwia współpracę klas o niekompatybilnych interfejsach.
- Tworzy „tłumacza”, który implementuje oczekiwany interfejs i deleguje działania do klasy źródłowej.
- Często wykorzystywany przy integracji starych bibliotek lub systemów.

## 7. Bridge

SRP + ISP + DIP dla hierarchii o dwóch stopniach swobody.

**Cel:** Oddzielenie abstrakcji od implementacji.

- Stosowany gdy obiekt ma dwie niezależnie zmieniające się odpowiedzialności.
- Przykład:
  - **Stopień 1:** pozyskiwanie danych (np. z SQL, XML)
  - **Stopień 2:** przetwarzanie danych (np. wypisanie na konsolę, wysyłka do usługi)
  - Podczas tworzebnia obiektu podajemy niezależnie sposób pozyskiwania danych oraz ich przetwarzania
- Bridge umożliwia niezależny rozwój obu aspektów.

