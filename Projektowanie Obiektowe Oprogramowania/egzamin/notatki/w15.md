# Wykład 15 - Service Oriented Architecture

## 1. Modele integracji danych

Integracja danych eliminuje konieczność wielokrotnego wprowadzania tych samych danych w różnych systemach. 
Kluczowe jest rozdzielenie poziomu technicznego (jak przekazywać dane) od poziomu analitycznego (co i kiedy przekazywać).

### 1.1 Integracja przez wymianę plików

**Zalety:**
- Możliwość użycia w heterogenicznych środowiskach.

**Wady:**
- Wymaga ręcznej ingerencji użytkownika.
- Automatyzacja wymaga współdzielenia nośnika.
- Potencjalne ryzyko wycieku danych (brak szyfrowania).

### 1.2 Integracja przez wspólną bazę danych

**Zalety:**
- Natychmiastowa i automatyczna integracja.

**Wady:**
- Trudna skalowalność (powyżej ~1000 tabel).
- Problemy w integracji aplikacji od różnych dostawców.
- Wysoka złożoność zarządzania.

### 1.3 Integracja przez usługi aplikacyjne (Web Services)

**Zalety:**
- Możliwość integracji różnych technologii.
- Standardy interoperacyjności (REST, WSDL).

**Wady:**
- Problem sieci połączeń „każdy z każdym” – liczba połączeń rośnie wykładniczo.

### 1.4 Integracja przez brokera/szynę usług

- Połączenie Web Services i Event Aggregator.
- Aplikacje publikują/subskrybują zdarzenia.
- Złożoność połączeń liniowa.
- Wiarygodne dostarczanie, uwierzytelnianie i standardy komunikacji.

## 2. Message Oriented Architecture (MOA)

Model architektury oparty na komunikatach, z użyciem Message-Oriented Middleware (MOM).

### Podejścia:

#### API Driven

- Abstrakcja poprzez interfejs (np. JMS).
- **Zalety:** wymienność dostawcy.
- **Wady:** brak interoperacyjności (np. z .NET, PHP).

#### Protocol Driven

- Abstrakcja poprzez protokół (np. AMQP).
- **Zalety:** rzeczywista interoperacyjność.
- **Wady:** może wymagać warstwy pośredniej dla spełnienia formalnych wymagań (np. XML/WSDL).

## 3. Enterprise Service Bus (ESB)

Szyna usług – zewnętrzna usługa typu MOM dla integracji systemów.

### 3.1 Wzorce komunikacyjne:

- **Publish/Subscribe (P/S):** rozdzielenie nadawców i odbiorców.
- **Request/Reply (R/R):** zapytanie i odpowiedź.
- **Saga (Long Running Transaction):** złożone procesy biznesowe z logiką warunkową.

### 3.2 Asynchroniczność

- Różne tempo przetwarzania u subskrybentów.
- Wymagane repozytorium trwałe (BD, kolejki).

### 3.3 Porty wejścia/wyjścia

- **Port wejścia:**
  - *Pull:* szyna monitoruje zasób (pliki, BD).
  - *Push:* dane dostarczane przez usługę aplikacyjną.

- **Port wyjścia:**
  - *Pull:* aplikacja subskrybenta monitoruje stan portu.
  - *Push:* szyna aktywnie przekazuje dane.

**Wydajność:** tryb push efektywniejszy, ale technicznie nie zawsze możliwy.

### 3.4 Szyna vs Business Process Engine

- **BPEL:** XML-owy język (traci na znaczeniu).
- **BPMN:** graficzna notacja procesów wspierana przez narzędzia (rekomendowana).

## 4. Command-Query Responsibility Segregation (CQRS)

Architektura systemu transakcyjnego z rozdzieleniem odczytu i zapisu.

**Cechy:**
- Odczyt występuje dużo częściej niż zapis (nawet 1000:1).
- Odczyt – struktura zdenormalizowana, zapis – znormalizowana.
- Możliwość użycia różnych baz danych (np. SQL + NoSQL).
- Komunikaty `Command` → aktualizacja → komunikaty `Change` → widok.
- Dobrze współgra z architekturą heksagonalną i systemami kolejkowymi.
