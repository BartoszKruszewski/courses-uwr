# Wykład 7 - Wzorce czynnościowe 2

## 1. Mediator

Koordynator komunikacji ściśle określonej grupy obiektów – dzięki niemu nie odwołują się do siebie wprost, lecz przesyłają powiadomienia przez mediatora.

- Uproszczony wariant Observera.
- Komunikuje ograniczoną grupę obiektów, do których ma jawne referencje.
- Kolaborujące obiekty powiadamiają się nawzajem o zmianie stanu (Mediator sam nie przechowuje stanu).

### Przykład:
Typowe okienka (Form) w aplikacjach desktopowych pełnią rolę mediatorów między kontrolkami wewnętrznymi.

## 2. Observer

Powiadamianie zainteresowanych o zmianie stanu – obiekty nie odwołują się do siebie wprost.

- Umożliwia komunikację między obiektami bez jawnych zależności.
- Uogólnia interfejs Mediatora – może obsługiwać dowolną liczbę obserwatorów poprzez listę.

### Przykład:
W architekturze aplikacji GUI:
- Wewnątrz okienka – używany Mediator.
- Pomiędzy różnymi okienkami – stosowany Observer.

## 3. Event Aggregator

Rozwiązuje problem Observera ogólniej – jeden mechanizm dla różnych typów powiadomień.

- Hub komunikacyjny: realizacja Observera jako słownika list słuchaczy, indeksowanych typem powiadomienia.
- Obiekty publikujące i subskrybujące nie muszą znać siebie nawzajem – jedynie EventAggregatora.

## 4. Memento

Zapamiętuj i odzyskuj stan obiektu.

### Charakterystyka:
- Obiekt Memento przechowuje stan innego obiektu (Originatora), który potrafi tworzyć i przywracać swoje Memento.
- Memento może przechowywać pełny stan lub tylko przyrostową zmianę (deltę).
- Stosowany m.in. do implementacji mechanizmu Undo/Redo.

### Undo/Redo – Założenia:
- Każda zmiana stanu powinna odkładać się w historii.
- Cofanie (Undo) możliwe do najdalszego zapamiętanego stanu.
- Przywracanie (Redo) możliwe, dopóki nie zmieniono stanu ręcznie.
- Zmiana po Undo usuwa "przyszłość".

### Implementacja:
- Stos do przechowywania historii `undo`.
- Stos do przywracania zmian `redo`.
- Podczas zmiany stanu:
  - Tworzone jest Memento i dodawane na stos `undo`.
  - Stos `redo` jest czyszczony.
- Przy `Undo`:
  - Bieżący stan trafia na stos `redo`, a poprzedni zostaje przywrócony.
- Przy `Redo`:
  - Stan z `redo` trafia na stos `undo` i zostaje przywrócony.
